---
import { StackDrawer } from '../../../components/organisms/drawer/stack-drawer'
import { getAllStackWithRelationsAndProjectsMin } from '../../../services/stack/getAllStackWithRelationsAndProjectsMin'
import Base from '../index.astro'

export async function getStaticPaths() {
  const stacks = await getAllStackWithRelationsAndProjectsMin()

  const paths = stacks.map(stack => ({
    params: { key: stack.id },
    props: stack
  }))

  return paths
}

const stack = Astro.props
---

<Base />
<StackDrawer
  stack={stack}
  drawerProps={{
    defaultOpen: true
  }}
  returnToSiteOnClose={{
    site: '/stack',
    keepState: true
  }}
  client:load
/>
