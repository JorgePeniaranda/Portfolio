import{r as i}from"./index.DrxKNVES.js";import{c as h}from"./index.BJknnQuW.js";import{P as R,d as j}from"./index.2EOGNVNh.js";import{u as g}from"./index.1JkRN11X.js";import{a as m}from"./index.qJiwp9Ip.js";import{j as x}from"./jsx-runtime.EKYJJIwR.js";function z(n,e=globalThis?.document){const t=m(n);i.useEffect(()=>{const o=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",o,{capture:!0}),()=>e.removeEventListener("keydown",o,{capture:!0})},[t,e])}var H="DismissableLayer",p="dismissableLayer.update",K="dismissableLayer.pointerDownOutside",M="dismissableLayer.focusOutside",C,B=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),T=i.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:c,onInteractOutside:f,onDismiss:d,...E}=n,a=i.useContext(B),[u,S]=i.useState(null),l=u?.ownerDocument??globalThis?.document,[,W]=i.useState({}),k=g(e,r=>S(r)),b=Array.from(a.layers),[A]=[...a.layersWithOutsidePointerEventsDisabled].slice(-1),N=b.indexOf(A),D=u?b.indexOf(u):-1,_=a.layersWithOutsidePointerEventsDisabled.size>0,P=D>=N,U=Y(r=>{const v=r.target,L=[...a.branches].some(y=>y.contains(v));!P||L||(s?.(r),f?.(r),r.defaultPrevented||d?.())},l),O=q(r=>{const v=r.target;[...a.branches].some(y=>y.contains(v))||(c?.(r),f?.(r),r.defaultPrevented||d?.())},l);return z(r=>{D===a.layers.size-1&&(o?.(r),!r.defaultPrevented&&d&&(r.preventDefault(),d()))},l),i.useEffect(()=>{if(u)return t&&(a.layersWithOutsidePointerEventsDisabled.size===0&&(C=l.body.style.pointerEvents,l.body.style.pointerEvents="none"),a.layersWithOutsidePointerEventsDisabled.add(u)),a.layers.add(u),w(),()=>{t&&a.layersWithOutsidePointerEventsDisabled.size===1&&(l.body.style.pointerEvents=C)}},[u,l,t,a]),i.useEffect(()=>()=>{u&&(a.layers.delete(u),a.layersWithOutsidePointerEventsDisabled.delete(u),w())},[u,a]),i.useEffect(()=>{const r=()=>W({});return document.addEventListener(p,r),()=>document.removeEventListener(p,r)},[]),x.jsx(R.div,{...E,ref:k,style:{pointerEvents:_?P?"auto":"none":void 0,...n.style},onFocusCapture:h(n.onFocusCapture,O.onFocusCapture),onBlurCapture:h(n.onBlurCapture,O.onBlurCapture),onPointerDownCapture:h(n.onPointerDownCapture,U.onPointerDownCapture)})});T.displayName=H;var X="DismissableLayerBranch",F=i.forwardRef((n,e)=>{const t=i.useContext(B),o=i.useRef(null),s=g(e,o);return i.useEffect(()=>{const c=o.current;if(c)return t.branches.add(c),()=>{t.branches.delete(c)}},[t.branches]),x.jsx(R.div,{...n,ref:s})});F.displayName=X;function Y(n,e=globalThis?.document){const t=m(n),o=i.useRef(!1),s=i.useRef(()=>{});return i.useEffect(()=>{const c=d=>{if(d.target&&!o.current){let E=function(){I(K,t,a,{discrete:!0})};const a={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=E,e.addEventListener("click",s.current,{once:!0})):E()}else e.removeEventListener("click",s.current);o.current=!1},f=window.setTimeout(()=>{e.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(f),e.removeEventListener("pointerdown",c),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>o.current=!0}}function q(n,e=globalThis?.document){const t=m(n),o=i.useRef(!1);return i.useEffect(()=>{const s=c=>{c.target&&!o.current&&I(M,t,{originalEvent:c},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function w(){const n=new CustomEvent(p);document.dispatchEvent(n)}function I(n,e,t,{discrete:o}){const s=t.originalEvent.target,c=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),o?j(s,c):s.dispatchEvent(c)}var ee=T,te=F;export{te as B,T as D,ee as R};
