import{j as e}from"./jsx-runtime.EKYJJIwR.js";import{r as m}from"./index.DrxKNVES.js";import{u as P,F as T,a as F,b as v,d as D}from"./form.93GIvI3c.js";import{B as j}from"./button.x7-QiqwQ.js";import{C as z,a as E}from"./card.BAnZFR_a.js";import{D as k,a as A,b as R,c as $,d as O,e as M,f as V}from"./dialog.C0ZfxG5a.js";import{S as I,a as U,b as q,c as B,d as H}from"./select.BKrJ3BO-.js";import{i as y}from"./is-defined.BPY7jSh6.js";import{u as W}from"./use-toast.BikYzejn.js";import{a as w,h as S,b as N}from"./toast-handler.D8rKeUy-.js";import{X}from"./x.DYFGPTRN.js";import{P as G}from"./plus.CAt6JUe3.js";import"./index.BLEmuFXE.js";import"./index.1JkRN11X.js";import"./index.2EOGNVNh.js";import"./index.rqUiOy30.js";import"./index.B2LyIUNT.js";import"./index.Li38iYKq.js";import"./classnames.B8F8Dq1p.js";import"./index.BZXvyPAu.js";import"./index.BJknnQuW.js";import"./index.qJiwp9Ip.js";import"./index.BRpELbpY.js";import"./index.yusZEH1f.js";import"./Combination.CoL-rreF.js";import"./index.CdA-AeYO.js";import"./index.CwYy1fy-.js";import"./index.CoUN5iVw.js";import"./index.Ca4aSXhd.js";import"./index.CGPvhYpy.js";import"./index.wLl3Idx7.js";import"./chevrons-up-down.BMPs55cN.js";import"./createLucideIcon.D2R2PR3o.js";import"./chevron-down.DmgAbkcx.js";import"./env.T9ZNvZgm.js";import"./dev-console-log.CInb5xbI.js";import"./index.CdM0oSJi.js";import"./message-display.CI2NEmxy.js";async function J(i){try{const{idFrom:t,idTo:l}=i,{data:s}=await w.post(`/api/collaborator/id/${t}/project/${l}`);return s}catch(t){throw S({error:t,defaultErrorMessage:"No se pudo agregar el proyecto al colaborador."})}}async function K(i){try{const{idFrom:t,idTo:l}=i,{data:s}=await w.delete(`/api/collaborator/id/${t}/project/${l}`);return s}catch(t){throw S({error:t,defaultErrorMessage:"No se pudo eliminar el proyecto del colaborador."})}}function Ae({currentCollaborator:i,associatedProjects:t,availableProject:l,disableForm:s}){const{toast:p}=W(),[C,n]=m.useState(!1),[x,h]=m.useState(t),[u,g]=m.useState(l),c=P({defaultValues:{idFrom:i.id}}),f=async r=>{try{await J({idFrom:Number(r.idFrom),idTo:Number(r.idTo)}),c.reset(),p({title:"Proyecto relacionado con el colaborador",description:"El proyecto ha sido relacionado con el colaborador exitosamente.",className:"bg-green-500 text-black"});const o=u.find(a=>a.id===Number(r.idTo));y(o)&&(h(a=>[...a,o]),g(a=>a.filter(d=>d.id!==Number(r.idTo)))),n(!1)}catch(o){N({error:o,title:"No se pudo relacionar el proyecto con el colaborador",defaultErrorMessage:"Ocurrió un error al intentar relacionar el proyecto con el colaborador.",tryAgain:()=>f(r)})}},b=async r=>{try{await K({idFrom:i.id,idTo:r}),p({title:"Proyecto eliminado",description:"El proyecto ha sido eliminado del colaborador exitosamente.",className:"bg-green-500 text-black"});const o=x.find(a=>a.id===r);y(o)&&(h(a=>a.filter(d=>d.id!==r)),g(a=>[...a,o])),n(!1)}catch(o){N({error:o,title:"No se pudo eliminar el proyecto del colaborador",defaultErrorMessage:"Ocurrió un error al intentar eliminar el proyecto del colaborador.",tryAgain:()=>b(r)})}};return e.jsxs("ul",{className:"mt-4 flex flex-wrap gap-4",children:[x?.map(r=>e.jsx("li",{children:e.jsx(z,{className:"my-5 flex flex-col items-center justify-center rounded-lg bg-zinc-300 shadow dark:bg-zinc-800",children:e.jsxs(E,{className:"relative flex items-center gap-2",children:[e.jsxs(j,{"aria-label":"eliminar relacion",className:"absolute -right-2.5 -top-2.5 m-0 flex aspect-square size-8 items-center justify-center rounded-full bg-red-500 p-0 text-center text-white hover:bg-red-600 dark:bg-red-600 dark:hover:bg-red-500",disabled:s,onClick:()=>b(r.id),children:[e.jsx(X,{}),e.jsx("span",{className:"sr-only",children:"eliminar relacion"})]}),e.jsx("img",{alt:`${r.name} logo`,className:"size-16 shrink-0",src:r.logoUrl}),e.jsx("span",{className:"text-lg capitalize",children:r.name})]})})},r.id)),e.jsx("li",{children:e.jsxs(k,{open:C,onOpenChange:n,children:[e.jsx(A,{asChild:!0,children:e.jsx("button",{"aria-label":"Relacionar stack",className:"my-5 flex aspect-square w-max flex-col items-center justify-center rounded-lg bg-zinc-300 p-6 shadow dark:bg-zinc-800",type:"button",children:e.jsx(G,{className:"size-20"})})}),e.jsxs(R,{className:"sm:max-w-[425px]",children:[e.jsxs($,{children:[e.jsx(O,{className:"text-center",children:"Relacionar proyecto"}),e.jsx(M,{children:"Selecciona un proyecto para relacionar con el colaborador."})]}),e.jsx(T,{...c,children:e.jsx("form",{className:"space-y-8",id:"relation-with-project-from-collaborator",onSubmit:c.handleSubmit(f),children:e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsx(F,{control:c.control,name:"idTo",render:({field:r})=>e.jsx(v,{className:"mx-auto",children:e.jsx(D,{children:e.jsxs(I,{defaultValue:String(r.value),onValueChange:r.onChange,...r,value:String(r.value),children:[e.jsx(U,{className:"w-[180px]",children:e.jsx(q,{placeholder:"Seleccionar proyecto"})}),e.jsx(B,{children:u.map(o=>e.jsx(H,{value:String(o.id),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{alt:`${o.name} logo`,className:"size-6",src:o.logoUrl}),e.jsx("span",{children:o.name})]})},o.id))})]})})})})})})}),e.jsx(V,{children:e.jsx(j,{className:"bg-zinc-800 text-white hover:bg-zinc-700",disabled:s,form:"relation-with-project-from-collaborator",type:"submit",typeof:"submit",children:"Relacionar"})})]})]})})]})}export{Ae as UpdateProjectsRelatedToCollaborator};
