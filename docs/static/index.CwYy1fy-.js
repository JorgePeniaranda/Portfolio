import{r as i}from"./index.DrxKNVES.js";import{u as y}from"./index.1JkRN11X.js";import{u as A}from"./index.qJiwp9Ip.js";function E(e,n){return i.useReducer(((e,t)=>n[e][t]??e),e)}var T=e=>{const{present:n,children:t}=e,r=P(n),o="function"==typeof t?t({present:r.isPresent}):i.Children.only(t),u=y(r.ref,R(o));return"function"==typeof t||r.isPresent?i.cloneElement(o,{ref:u}):null};function P(e){const[n,t]=i.useState(),r=i.useRef({}),o=i.useRef(e),u=i.useRef("none"),s=e?"mounted":"unmounted",[a,c]=E(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return i.useEffect((()=>{const e=l(r.current);u.current="mounted"===a?e:"none"}),[a]),A((()=>{const n=r.current,t=o.current;if(t!==e){const r=u.current,i=l(n);c(e?"MOUNT":"none"===i||"none"===n?.display?"UNMOUNT":t&&r!==i?"ANIMATION_OUT":"UNMOUNT"),o.current=e}}),[e,c]),A((()=>{if(n){let e;const t=n.ownerDocument.defaultView??window,i=i=>{const u=l(r.current).includes(i.animationName);if(i.target===n&&u&&(c("ANIMATION_END"),!o.current)){const r=n.style.animationFillMode;n.style.animationFillMode="forwards",e=t.setTimeout((()=>{"forwards"===n.style.animationFillMode&&(n.style.animationFillMode=r)}))}},s=e=>{e.target===n&&(u.current=l(r.current))};return n.addEventListener("animationstart",s),n.addEventListener("animationcancel",i),n.addEventListener("animationend",i),()=>{t.clearTimeout(e),n.removeEventListener("animationstart",s),n.removeEventListener("animationcancel",i),n.removeEventListener("animationend",i)}}c("ANIMATION_END")}),[n,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:i.useCallback((e=>{e&&(r.current=getComputedStyle(e)),t(e)}),[])}}function l(e){return e?.animationName||"none"}function R(e){let n=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=n&&"isReactWarning"in n&&n.isReactWarning;return t?e.ref:(n=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=n&&"isReactWarning"in n&&n.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}T.displayName="Presence";export{T as P};